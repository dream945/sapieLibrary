# サピエライブラリ NVDA アドオン

## 概要

サピエライブラリは、視覚障害者向けの電子図書館「サピエ図書館」にアクセスし、点字図書やDAISY図書を検索・ダウンロード・閲覧できるNVDAアドオンです。

## 機能

- サピエ図書館へのログイン
- 点字図書・DAISY図書の検索
- 図書のダウンロード
- ダウンロードした点字データの閲覧（カナ変換、Unicode点字、外部エディタ対応）
- 既存の点字図書ファイルを開く
- 複数巻（複数BESファイル）に対応

## 動作要件

- NVDA 2019.3以降
- サピエ図書館のアカウント（サピエID・パスワード）
- インターネット接続

## インストール方法

1. `sapieLibrary.nvda-addon` ファイルをダブルクリック
2. NVDAのアドオンインストール確認画面で「はい」を選択
3. NVDAを再起動

## 使い方

### サピエ図書館ダイアログを開く

NVDAメニュー → ツール → サピエ図書館

### ログイン

1. ダイアログが開いたら、サピエIDとパスワードを入力
2. 「ログイン」ボタンをクリック
3. ログインに成功すると検索タブが有効になります

### 図書の検索

ログイン後、以下のタブから検索できます：

- **点字図書検索**: 点字図書を検索
- **DAISY図書検索**: DAISY図書を検索
- **新着図書**: 最新の登録図書を表示
- **お気に入り**: お気に入り登録した図書を表示

検索方法：
1. 検索キーワードを入力
2. 「検索」ボタンをクリック
3. 検索結果一覧から図書を選択

### 図書のダウンロード

1. 検索結果から図書を選択
2. 「ダウンロード」ボタンをクリック
3. ダウンロード完了後、「この図書を閲覧しますか？」ダイアログが表示されます
4. 「はい」を選択すると、設定に従って図書が開きます

### 図書の詳細情報

1. 検索結果から図書を選択
2. 「詳細」ボタンをクリック
3. 図書の詳細情報（著者、出版社、内容紹介など）が表示されます

### 既存の図書を開く

ダウンロード済みの図書を開くには：

1. ダイアログ下部の「図書を開く」ボタンをクリック
2. ファイル選択ダイアログで点字図書ファイル（.zip または .exe）を選択
3. 「この図書を閲覧しますか？」ダイアログで「はい」を選択
4. 設定に従って図書が開きます

**注意**: 複数巻に分かれた図書（複数のBESファイル）の場合、「外部エディタで開く」を選択すると、すべての巻が同時に開きます。

## 設定

NVDAメニュー → 設定 → 設定... → サピエ図書館

### アカウント設定

| 設定項目 | 説明 |
|----------|------|
| ダウンロード先フォルダ | 図書をダウンロードするフォルダを指定 |
| ログイン情報を保存する | チェックするとサピエID・パスワードを保存 |
| サピエID | サピエ図書館のログインID |
| パスワード | サピエ図書館のパスワード |
| 起動時に自動ログイン | ダイアログを開いたときに自動でログイン |

### 閲覧設定

| 設定項目 | 説明 |
|----------|------|
| 点字データの表示形式 | ダウンロード後の表示方法を選択 |
| 外部エディタ | 「外部エディタで開く」選択時に使用するプログラム |

#### 点字データの表示形式

- **カナで表示**: 点字をカタカナに変換してメモ帳で表示
- **Unicode点字で表示**: 点字をUnicode点字パターンでメモ帳に表示（点字ディスプレイ使用時に便利）
- **外部エディタで開く**: 元のBESファイルを指定したエディタで開く（点字編集ソフト使用時に便利）

## 対応フォーマット

### ダウンロード

- 点字図書（BES形式、ZIP圧縮）
- DAISY図書

### 閲覧

- BES形式の点字データ

## トラブルシューティング

### ログインできない

- サピエIDとパスワードが正しいか確認してください
- インターネット接続を確認してください
- サピエ図書館のウェブサイトにブラウザからログインできるか確認してください

### ダウンロードできない

- ダウンロード先フォルダが存在し、書き込み権限があるか確認してください
- ディスクの空き容量を確認してください

### 閲覧できない

- ダウンロードしたファイルが破損していないか確認してください
- 「外部エディタで開く」を選択している場合、エディタのパスが正しいか確認してください

## 変更履歴

### バージョン 1.0.0

- 初回リリース
- サピエ図書館へのログイン機能
- 点字図書・DAISY図書の検索機能
- 図書のダウンロード機能
- 点字データの閲覧機能（カナ変換、Unicode点字、外部エディタ対応）

## ライセンス

GPL v2

## 作者

サピエライブラリアドオン開発チーム

## 謝辞

- サピエ図書館（https://www.sapie.or.jp/）
- NVDA日本語チーム
- TenjiTexterモジュール開発者
